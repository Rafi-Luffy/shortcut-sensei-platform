<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community - Shortcut Sensei</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="enhanced-styles.css">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        /* Premium Community Page Styles with Cool Animations */
        :root {
            --primary: #6366f1;
            --primary-rgb: 99, 102, 241;
            --accent: #8b5cf6;
            --surface: #ffffff;
            --bg-primary: #fafafa;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --border: #e5e7eb;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        /* Premium Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200px 0;
            }
            100% {
                background-position: calc(200px + 100%) 0;
            }
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                opacity: 1;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(var(--primary-rgb), 0.3);
            }
            50% {
                box-shadow: 0 0 30px rgba(var(--primary-rgb), 0.6);
            }
        }

        /* Community Page Layout */
        .community-page {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding-top: 100px;
            position: relative;
            overflow-x: hidden;
        }

        .community-page::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: linear-gradient(135deg, rgba(var(--primary-rgb), 0.1), rgba(var(--accent), 0.1));
            z-index: 0;
        }

        .page-title {
            text-align: center;
            margin-bottom: 50px;
            padding: 0 20px;
            position: relative;
            z-index: 1;
            animation: fadeInUp 0.8s ease-out;
        }

        .page-title h1 {
            font-size: 3em;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            position: relative;
        }

        .page-title h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 2px;
        }

        .page-title p {
            font-size: 1.3em;
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Premium Stats Grid */
        .community-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 60px;
            padding: 0 20px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
            position: relative;
            z-index: 1;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 35px 25px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out;
            animation-fill-mode: both;
        }

        .stat-card:nth-child(2) { animation-delay: 0.1s; }
        .stat-card:nth-child(3) { animation-delay: 0.2s; }
        .stat-card:nth-child(4) { animation-delay: 0.3s; }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.5s;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            animation: glow 2s infinite;
        }

        .stat-card i {
            font-size: 3em;
            color: var(--primary);
            margin-bottom: 20px;
            display: block;
            transition: all 0.3s ease;
        }

        .stat-card:hover i {
            transform: rotate(360deg) scale(1.1);
            color: var(--accent);
        }

        .stat-number {
            display: block;
            font-size: 2.8em;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            font-family: 'SF Pro Display', system-ui, sans-serif;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 1.1em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Premium Content Layout */
        .community-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 40px;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            margin-bottom: 60px;
            position: relative;
            z-index: 1;
        }

        /* Premium Question Form */
        .question-form-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: fit-content;
            position: sticky;
            top: 120px;
            animation: slideInRight 0.8s ease-out;
            transition: all 0.3s ease;
        }

        .question-form-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .question-form-heading {
            margin-bottom: 30px;
            font-size: 1.8em;
            color: var(--text-primary);
            font-weight: 700;
            text-align: center;
            position: relative;
        }

        .question-form-heading::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 2px;
        }

        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1.1em;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--border);
            border-radius: 16px;
            font-size: 1em;
            background: rgba(255, 255, 255, 0.8);
            color: var(--text-primary);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 0 0 4px rgba(var(--primary-rgb), 0.1);
            transform: translateY(-2px);
        }

        .form-group textarea {
            min-height: 140px;
            resize: vertical;
        }

        .form-submit {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 16px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(var(--primary-rgb), 0.4);
            animation: pulse 2s infinite;
        }

        .form-submit:active {
            transform: translateY(-1px);
        }

        /* Premium Quiz Section Styles */
        .community-quiz-section {
            padding: 80px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        .quiz-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 0;
        }

        .quiz-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,0.3), transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.2), transparent),
                radial-gradient(1px 1px at 90px 40px, rgba(255,255,255,0.3), transparent);
            background-repeat: repeat;
            background-size: 100px 100px;
            animation: shimmer 20s linear infinite;
        }

        .section-header {
            text-align: center;
            margin-bottom: 50px;
            position: relative;
            z-index: 1;
            animation: fadeInUp 0.8s ease-out;
        }

        .section-header h2 {
            font-size: 2.5em;
            color: white;
            margin-bottom: 15px;
            font-weight: 800;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .section-header p {
            color: rgba(255,255,255,0.9);
            font-size: 1.2em;
            max-width: 600px;
            margin: 0 auto;
        }

        .quiz-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }

        .quiz-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: slideInRight 0.8s ease-out;
            transition: all 0.3s ease;
        }

        .quiz-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }

        .quiz-header h3 {
            color: var(--text-primary);
            font-size: 1.6em;
            margin: 0;
            font-weight: 700;
        }

        .quiz-timer {
            display: flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(var(--primary-rgb), 0.3);
            animation: pulse 2s infinite;
        }

        .quiz-option {
            background: rgba(248, 250, 252, 0.8);
            border: 3px solid var(--border);
            padding: 20px 25px;
            border-radius: 16px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--text-primary);
            font-size: 1.1em;
            font-weight: 500;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }

        .quiz-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(var(--primary-rgb), 0.2), transparent);
            transition: left 0.5s;
        }

        .quiz-option:hover::before {
            left: 100%;
        }

        .quiz-option:hover {
            border-color: var(--primary);
            background: rgba(var(--primary-rgb), 0.1);
            transform: translateX(10px);
            box-shadow: 0 8px 25px rgba(var(--primary-rgb), 0.2);
        }

        .quiz-option.correct {
            border-color: #22c55e;
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            color: #15803d;
            animation: bounceIn 0.6s ease-out;
        }

        .quiz-option.incorrect {
            border-color: #ef4444;
            background: linear-gradient(135deg, #fef2f2, #fecaca);
            color: #dc2626;
            animation: bounceIn 0.6s ease-out;
        }

        .quiz-leaderboard {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 35px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            height: fit-content;
            animation: fadeInUp 0.8s ease-out;
            animation-delay: 0.2s;
            animation-fill-mode: both;
        }

        .quiz-leaderboard h3 {
            color: var(--text-primary);
            margin-bottom: 25px;
            text-align: center;
            font-size: 1.4em;
            font-weight: 700;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .leaderboard-item:hover {
            background: rgba(var(--primary-rgb), 0.05);
            transform: translateX(5px);
        }

        .rank {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1em;
            color: white;
        }

        .rank.gold {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
        }

        .rank.silver {
            background: linear-gradient(135deg, #c0c0c0, #e5e5e5);
            box-shadow: 0 4px 15px rgba(192, 192, 192, 0.4);
        }

        .rank.bronze {
            background: linear-gradient(135deg, #cd7f32, #d4a574);
            box-shadow: 0 4px 15px rgba(205, 127, 50, 0.4);
        }

        .start-quiz-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 18px;
            border-radius: 16px;
            cursor: pointer;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 20px;
        }

        .start-quiz-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(var(--primary-rgb), 0.4);
            animation: glow 2s infinite;
        }

        /* Enhanced Quiz Features */
        .quiz-modes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .mode-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .mode-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(var(--primary-rgb), 0.3);
        }

        .mode-card.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(var(--primary-rgb), 0.1), rgba(var(--accent), 0.1));
        }

        .mode-icon {
            font-size: 2em;
            margin-bottom: 10px;
            display: block;
        }

        .mode-title {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .mode-description {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        .quiz-settings {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .settings-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .slider {
            width: 120px;
            height: 6px;
            border-radius: 3px;
            background: var(--border);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(var(--primary-rgb), 0.3);
        }

        .timer-display {
            font-size: 1.2em;
            font-weight: 700;
            color: var(--primary);
        }

        .score-board {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .score-number {
            font-size: 2.5em;
            font-weight: 900;
            margin-bottom: 5px;
        }

        .streak-indicator {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            display: inline-block;
            margin-top: 10px;
        }

        /* Battle Mode Styles */
        .battle-arena {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 20px;
            padding: 30px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .battle-arena::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="80" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="40" cy="60" r="1" fill="rgba(255,255,255,0.1)"/></svg>');
            animation: float 10s ease-in-out infinite;
        }

        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .player-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .player-card.active {
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .player-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            margin: 0 auto 10px;
        }

        .player-name {
            font-weight: 700;
            margin-bottom: 5px;
        }

        .player-score {
            font-size: 1.5em;
            font-weight: 900;
            color: #ffd700;
        }

        .battle-question {
            background: rgba(255, 255, 255, 0.9);
            color: var(--text-primary);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .battle-timer {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 1.2em;
        }

        .waiting-room {
            text-align: center;
            padding: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Answer Feedback Animations */
        .quiz-option.answering {
            animation: pulse 0.5s ease-in-out;
        }

        .quiz-option.correct {
            animation: correctAnswer 0.8s ease-out;
        }

        .quiz-option.incorrect {
            animation: incorrectAnswer 0.8s ease-out;
        }

        @keyframes correctAnswer {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); background: #22c55e; color: white; }
            100% { transform: scale(1); }
        }

        @keyframes incorrectAnswer {
            0% { transform: scale(1); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        .answer-feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 20px 30px;
            border-radius: 16px;
            font-size: 1.5em;
            font-weight: 700;
            z-index: 1000;
            animation: feedbackPop 1s ease-out;
        }

        @keyframes feedbackPop {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }

        /* Progress Enhancements */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        /* Time Challenge Mode */
        .challenge-mode {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            border-radius: 20px;
            padding: 25px;
            color: white;
            margin-bottom: 20px;
        }

        .challenge-timer {
            font-size: 3em;
            font-weight: 900;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .challenge-stats {
            display: flex;
            justify-content: space-around;
            text-align: center;
        }

        .challenge-stat {
            font-weight: 700;
        }

        .challenge-stat-number {
            font-size: 1.8em;
            display: block;
        }

        /* User Profile Modal */
        .profile-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }

        .profile-modal.active {
            display: flex;
        }

        .profile-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideInUp 0.4s ease-out;
        }

        .profile-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }

        .profile-close:hover {
            color: var(--primary);
            transform: rotate(90deg);
        }

        .profile-hero {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 20px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .profile-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="80" r="2" fill="rgba(255,255,255,0.1)"/></svg>');
            animation: float 15s ease-in-out infinite;
        }

        .profile-avatar-large {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #fff, #f0f0f0);
            color: var(--primary);
            font-size: 3em;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 1;
        }

        .profile-username {
            font-size: 2.5em;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .profile-title-large {
            font-size: 1.3em;
            opacity: 0.9;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .profile-level {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .profile-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--border);
        }

        .profile-tab {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .profile-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .profile-tab:hover {
            color: var(--primary);
            background: rgba(var(--primary-rgb), 0.05);
        }

        .profile-content {
            min-height: 300px;
        }

        .profile-section {
            display: none;
        }

        .profile-section.active {
            display: block;
            animation: fadeInUp 0.4s ease-out;
        }

        /* Battle History */
        .battle-history {
            display: grid;
            gap: 15px;
        }

        .battle-record {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 16px;
            padding: 20px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
        }

        .battle-record:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .battle-record.win {
            border-left-color: #22c55e;
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.05), transparent);
        }

        .battle-record.loss {
            border-left-color: #ef4444;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05), transparent);
        }

        .battle-record.tie {
            border-left-color: #f59e0b;
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.05), transparent);
        }

        .battle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .battle-result {
            font-weight: 800;
            font-size: 1.1em;
        }

        .battle-result.win { color: #22c55e; }
        .battle-result.loss { color: #ef4444; }
        .battle-result.tie { color: #f59e0b; }

        .battle-mode {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .battle-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            font-size: 0.9em;
        }

        .battle-stat {
            text-align: center;
        }

        .battle-stat-value {
            font-weight: 700;
            font-size: 1.2em;
            color: var(--primary);
        }

        .battle-stat-label {
            color: var(--text-secondary);
            text-transform: uppercase;
            font-size: 0.8em;
            letter-spacing: 0.5px;
        }

        /* Social Features */
        .social-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }

        .social-btn {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .social-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(var(--primary-rgb), 0.4);
        }

        .social-btn.secondary {
            background: rgba(var(--primary-rgb), 0.1);
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .social-btn.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        /* Room Creation */
        .room-creation {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid var(--primary);
        }

        .room-form {
            display: grid;
            gap: 20px;
        }

        .room-form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .room-input {
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .room-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(var(--primary-rgb), 0.1);
        }

        .create-room-btn {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .create-room-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(var(--primary-rgb), 0.4);
        }

        /* Friends List */
        .friends-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .friend-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .friend-card:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .friend-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
        }

        .friend-name {
            font-weight: 700;
            margin-bottom: 5px;
        }

        .friend-status {
            color: var(--text-secondary);
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .friend-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .friend-btn {
            padding: 8px 16px;
            border: 2px solid var(--primary);
            background: none;
            color: var(--primary);
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .friend-btn:hover {
            background: var(--primary);
            color: white;
        }

        .friend-btn.primary {
            background: var(--primary);
            color: white;
        }

        /* Random Battle Queue */
        .random-battle-section {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 20px;
            padding: 30px;
            color: white;
            text-align: center;
            margin-bottom: 30px;
        }

        .queue-status {
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .queue-timer {
            font-size: 3em;
            font-weight: 900;
            margin-bottom: 15px;
            color: #ffd700;
        }

        .queue-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .queue-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .queue-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .queue-btn.cancel {
            background: rgba(239, 68, 68, 0.8);
            border-color: rgba(239, 68, 68, 1);
        }

        /* Premium User Profiles Styles */
        .user-profiles-section {
            padding: 80px 0;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            position: relative;
            overflow: hidden;
        }

        .profiles-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 0;
        }

        .floating-shapes {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .floating-shapes::before,
        .floating-shapes::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 6s ease-in-out infinite;
        }

        .floating-shapes::before {
            width: 200px;
            height: 200px;
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }

        .floating-shapes::after {
            width: 150px;
            height: 150px;
            top: 60%;
            right: 15%;
            animation-delay: 3s;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-30px);
            }
        }

        .user-profiles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }

        .user-profile-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 35px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out;
            animation-fill-mode: both;
        }

        .user-profile-card:nth-child(2) { animation-delay: 0.1s; }
        .user-profile-card:nth-child(3) { animation-delay: 0.2s; }

        .user-profile-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
        }

        .user-profile-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);
            animation: glow 2s infinite;
        }

        .profile-header {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            align-items: center;
        }

        .user-avatar.large {
            width: 70px;
            height: 70px;
            font-size: 1.8em;
            font-weight: 900;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .user-avatar.large.expert {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .user-avatar.large.designer {
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }

        .user-avatar.large.office {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
        }

        .user-avatar.large:hover {
            transform: rotate(360deg) scale(1.1);
        }

        .user-details h3 {
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 1.4em;
            font-weight: 700;
        }

        .user-title {
            color: var(--text-secondary);
            margin-bottom: 15px;
            font-style: italic;
            font-size: 1.1em;
        }

        .user-badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .badge {
            font-size: 0.8em;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .badge:hover {
            transform: scale(1.05);
        }

        .badge.moderator {
            background: linear-gradient(135deg, #4caf50, #66bb6a);
            color: white;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .badge.expert {
            background: linear-gradient(135deg, #2196f3, #42a5f5);
            color: white;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
        }

        .badge.contributor {
            background: linear-gradient(135deg, #ff9800, #ffa726);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }

        .badge.helper {
            background: linear-gradient(135deg, #9c27b0, #ba68c8);
            color: white;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.3);
        }

        .profile-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(var(--primary-rgb), 0.05);
            border-radius: 16px;
            border: 1px solid rgba(var(--primary-rgb), 0.1);
        }

        .profile-stats .stat {
            text-align: center;
            transition: all 0.3s ease;
        }

        .profile-stats .stat:hover {
            transform: scale(1.1);
        }

        .profile-stats .stat-number {
            display: block;
            font-size: 1.8em;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
        }

        .profile-stats .stat-label {
            font-size: 0.9em;
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .profile-specialties h4 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1.1em;
            font-weight: 700;
        }

        .specialty-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .specialty-tags .tag {
            background: linear-gradient(135deg, rgba(var(--primary-rgb), 0.1), rgba(var(--accent), 0.1));
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            border: 2px solid rgba(var(--primary-rgb), 0.2);
            transition: all 0.3s ease;
        }

        .specialty-tags .tag:hover {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(var(--primary-rgb), 0.3);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav-modern">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="index-enhanced.html" class="logo-link">
                    <span class="logo-text">Shortcut Sensei</span>
                </a>
            </div>
            
            <div class="nav-links">
                <a href="index-enhanced.html" class="nav-link">
                    <i data-lucide="home"></i>
                    <span>Home</span>
                </a>
                <a href="all-applications-enhanced.html" class="nav-link">
                    <i data-lucide="grid-3x3"></i>
                    <span>Applications</span>
                </a>
                <a href="quiz-enhanced.html" class="nav-link">
                    <i data-lucide="brain"></i>
                    <span>Quiz</span>
                </a>
                <a href="community-enhanced.html" class="nav-link active">
                    <i data-lucide="users"></i>
                    <span>Community</span>
                </a>
                <a href="About-enhanced.html" class="nav-link">
                    <i data-lucide="info"></i>
                    <span>About</span>
                </a>
            </div>
            
            <div class="nav-actions">
                <button class="search-toggle" id="search-toggle" aria-label="Search">
                    <i data-lucide="search"></i>
                </button>
                
                <div class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <i data-lucide="sun" class="theme-icon"></i>
                </div>
                
                <button class="auth-btn" id="authBtn">
                    <i data-lucide="user"></i>
                    <span>Sign In</span>
                </button>
            </div>
            
            <button class="nav-toggle" id="nav-toggle" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="community-page">
        <div class="page-title">
            <h1>Shortcut Sensei Community</h1>
            <p>Ask questions, share your knowledge, and connect with keyboard shortcut enthusiasts from around the world</p>
        </div>

        <div class="community-stats-grid" id="communityStats">
            <div class="stat-card">
                <i data-lucide="users"></i>
                <span class="stat-number" id="memberCount">5,782</span>
                <span class="stat-label">Community Members</span>
            </div>
            <div class="stat-card">
                <i data-lucide="help-circle"></i>
                <span class="stat-number" id="questionCount">2,456</span>
                <span class="stat-label">Questions Asked</span>
            </div>
            <div class="stat-card">
                <i data-lucide="message-circle"></i>
                <span class="stat-number" id="answerCount">12,890</span>
                <span class="stat-label">Helpful Answers</span>
            </div>
            <div class="stat-card">
                <i data-lucide="keyboard"></i>
                <span class="stat-number" id="shortcutCount">1,450</span>
                <span class="stat-label">Shortcuts Shared</span>
            </div>
        </div>

        <div class="community-content">
            <div class="question-form-container">
                <h2 class="question-form-heading">Ask a Question</h2>
                <form id="questionForm">
                    <div class="form-group">
                        <label for="questionTitle">Question Title</label>
                        <input type="text" id="questionTitle" placeholder="What's your question about?" required>
                    </div>
                    <div class="form-group">
                        <label for="questionDetails">Question Details</label>
                        <textarea id="questionDetails" placeholder="Provide details about your question..." required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="questionCategory">Category</label>
                        <select id="questionCategory" required>
                            <option value="">Select a category</option>
                            <option value="windows">Windows</option>
                            <option value="macos">macOS</option>
                            <option value="linux">Linux</option>
                            <option value="office">Microsoft Office</option>
                            <option value="adobe">Adobe Creative Suite</option>
                            <option value="browser">Web Browsers</option>
                            <option value="ide">Development IDEs</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="questionTags">Tags (comma separated)</label>
                        <input type="text" id="questionTags" placeholder="e.g., excel, formulas, navigation">
                    </div>
                    <button type="submit" class="form-submit">
                        <i data-lucide="send"></i>
                        Post Question
                    </button>
                </form>
            </div>

            <div class="question-list-container">
                <!-- Questions will be added here via JavaScript -->
            </div>
        </div>
    </div>

    <!-- Premium Quiz Section -->
    <section class="community-quiz-section">
        <div class="quiz-background">
            <div class="quiz-particles"></div>
        </div>
        
        <div class="community-content">
            <div class="section-header">
                <h2>Community Quiz Challenge</h2>
                <p>Test your shortcut knowledge and compete with fellow community members</p>
            </div>
            
            <div class="quiz-container" id="communityQuiz">
                <!-- Quiz Mode Selection -->
                <div class="quiz-modes" id="quizModes">
                    <div class="mode-card active" data-mode="solo">
                        <div class="mode-icon">🎯</div>
                        <div class="mode-title">Solo Practice</div>
                        <div class="mode-description">Practice at your own pace</div>
                    </div>
                    <div class="mode-card" data-mode="time-challenge">
                        <div class="mode-icon">⚡</div>
                        <div class="mode-title">Time Challenge</div>
                        <div class="mode-description">Race against the clock</div>
                    </div>
                    <div class="mode-card" data-mode="1v1">
                        <div class="mode-icon">⚔️</div>
                        <div class="mode-title">1v1 Battle</div>
                        <div class="mode-description">Duel with another player</div>
                    </div>
                    <div class="mode-card" data-mode="4v4">
                        <div class="mode-icon">🏆</div>
                        <div class="mode-title">4v4 Team Battle</div>
                        <div class="mode-description">Team competition</div>
                    </div>
                    <div class="mode-card" data-mode="ffa">
                        <div class="mode-icon">💥</div>
                        <div class="mode-title">Free For All</div>
                        <div class="mode-description">4-player showdown</div>
                    </div>
                </div>

                <!-- Quiz Settings -->
                <div class="quiz-settings" id="quizSettings">
                    <div class="settings-row">
                        <label>Number of Questions:</label>
                        <div class="settings-control">
                            <input type="range" class="slider" id="questionCount" min="5" max="20" value="10">
                            <span class="timer-display" id="questionCountDisplay">10</span>
                        </div>
                    </div>
                    <div class="settings-row">
                        <label>Time per Question:</label>
                        <div class="settings-control">
                            <input type="range" class="slider" id="timePerQuestion" min="10" max="60" value="30">
                            <span class="timer-display" id="timeDisplay">30s</span>
                        </div>
                    </div>
                    <div class="settings-row">
                        <label>Difficulty:</label>
                        <div class="settings-control">
                            <select id="difficulty" style="padding: 8px 12px; border-radius: 8px; border: 2px solid var(--border);">
                                <option value="easy">Easy</option>
                                <option value="medium" selected>Medium</option>
                                <option value="hard">Hard</option>
                                <option value="expert">Expert</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Solo Quiz Interface -->
                <div class="quiz-card" id="soloQuiz" style="display: none;">
                    <div class="quiz-header">
                        <h3 id="quizTitle">Daily Shortcut Challenge</h3>
                        <div class="quiz-timer">
                            <i data-lucide="clock"></i>
                            <span id="quizTimer">30</span>
                        </div>
                    </div>
                    
                    <div class="score-board">
                        <div class="score-number" id="currentScore">0</div>
                        <div>Score</div>
                        <div class="streak-indicator" id="streakDisplay">🔥 0 Streak</div>
                    </div>
                    
                    <div class="quiz-content" id="quizContent">
                        <div class="quiz-question">
                            <h4 id="currentQuestion">Which shortcut opens the Task Manager in Windows?</h4>
                            <div class="quiz-options" id="quizAnswers">
                                <button class="quiz-option" data-answer="0">Ctrl + Alt + Del</button>
                                <button class="quiz-option" data-answer="1">Ctrl + Shift + Esc</button>
                                <button class="quiz-option" data-answer="2">Alt + F4</button>
                                <button class="quiz-option" data-answer="3">Windows + R</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="quiz-footer">
                        <div class="quiz-progress">
                            <span id="questionProgress">Question 1 of 10</span>
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill" style="width: 10%"></div>
                            </div>
                        </div>
                        <button class="quiz-next-btn" id="nextQuestion" style="display: none;">Next Question</button>
                    </div>
                </div>

                <!-- Time Challenge Interface -->
                <div class="challenge-mode" id="timeChallenge" style="display: none;">
                    <div class="challenge-timer" id="challengeTimer">60</div>
                    <div class="challenge-stats">
                        <div class="challenge-stat">
                            <span class="challenge-stat-number" id="correctAnswers">0</span>
                            <div>Correct</div>
                        </div>
                        <div class="challenge-stat">
                            <span class="challenge-stat-number" id="totalAttempts">0</span>
                            <div>Total</div>
                        </div>
                        <div class="challenge-stat">
                            <span class="challenge-stat-number" id="accuracy">0%</span>
                            <div>Accuracy</div>
                        </div>
                    </div>
                    
                    <div class="battle-question" id="challengeQuestion">
                        <h4 id="challengeQuestionText">Get ready...</h4>
                        <div class="quiz-options" id="challengeAnswers"></div>
                    </div>
                </div>

                <!-- Battle Arena -->
                <div class="battle-arena" id="battleArena" style="display: none;">
                    <div class="battle-timer" id="battleTimer">30</div>
                    
                    <div class="players-grid" id="playersGrid">
                        <div class="player-card active">
                            <div class="player-avatar">YOU</div>
                            <div class="player-name">You</div>
                            <div class="player-score" id="yourScore">0</div>
                        </div>
                        <div class="player-card">
                            <div class="player-avatar">AI</div>
                            <div class="player-name">AI Opponent</div>
                            <div class="player-score" id="opponentScore">0</div>
                        </div>
                    </div>
                    
                    <div class="battle-question">
                        <h4 id="battleQuestionText">Waiting for players...</h4>
                        <div class="quiz-options" id="battleAnswers"></div>
                    </div>
                    
                    <div class="waiting-room" id="waitingRoom">
                        <div class="loading-spinner"></div>
                        <h3>Finding opponents...</h3>
                        <p>Please wait while we match you with other players</p>
                        <button class="quiz-next-btn" id="cancelBattle">Cancel</button>
                    </div>
                </div>

                <!-- Start Button -->
                <div class="quiz-start-container" id="startContainer">
                    <button class="start-quiz-btn" id="startQuiz">
                        <i data-lucide="play"></i>
                        Start Quiz Challenge
                    </button>
                </div>
                
                <div class="quiz-leaderboard">
                    <h3>🏆 Top Performers</h3>
                    <div class="leaderboard-list">
                        <div class="leaderboard-item">
                            <div class="rank gold">1</div>
                            <div class="user-avatar">JS</div>
                            <div class="user-info">
                                <span class="user-name">John Smith</span>
                                <span class="user-score">95 points</span>
                            </div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="rank silver">2</div>
                            <div class="user-avatar">ED</div>
                            <div class="user-info">
                                <span class="user-name">Emma Davis</span>
                                <span class="user-score">87 points</span>
                            </div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="rank bronze">3</div>
                            <div class="user-avatar">MJ</div>
                            <div class="user-info">
                                <span class="user-name">Mike Johnson</span>
                                <span class="user-score">82 points</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: rgba(var(--primary-rgb), 0.1); border-radius: 12px;">
                        <h4 style="margin-bottom: 10px; color: var(--primary);">🎮 Battle Stats</h4>
                        <div style="display: flex; justify-content: space-between; font-size: 0.9em;">
                            <span>1v1 Wins: <strong>12</strong></span>
                            <span>4v4 Wins: <strong>3</strong></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Random Battle & Room Creation Section -->
    <section style="padding: 60px 0; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">
            <div style="text-align: center; margin-bottom: 50px;">
                <h2 style="font-size: 2.5em; color: white; margin-bottom: 15px; font-weight: 800;">🎮 Battle Arena</h2>
                <p style="color: rgba(255,255,255,0.9); font-size: 1.2em;">Challenge friends or find random opponents for epic shortcut battles</p>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-bottom: 40px;">
                <!-- Random Battle Queue -->
                <div class="random-battle-section" id="randomBattleSection">
                    <h3 style="margin-bottom: 20px;">⚡ Quick Battle</h3>
                    <div class="queue-status" id="queueStatus">Ready to Battle!</div>
                    <div class="queue-timer" id="queueTimer" style="display: none;">00:00</div>
                    <p style="margin-bottom: 20px; opacity: 0.9;">Find a random opponent for instant battles</p>
                    
                    <div class="queue-actions">
                        <button class="queue-btn" id="joinQueueBtn">
                            <i data-lucide="zap"></i>
                            Join Queue
                        </button>
                        <button class="queue-btn cancel" id="cancelQueueBtn" style="display: none;">
                            <i data-lucide="x"></i>
                            Cancel
                        </button>
                    </div>
                </div>

                <!-- Room Creation -->
                <div class="room-creation" id="roomCreation">
                    <h3 style="margin-bottom: 20px; text-align: center; color: var(--primary);">🏠 Create Private Room</h3>
                    
                    <form class="room-form" id="roomForm">
                        <input type="text" class="room-input" id="roomName" placeholder="Room Name" required>
                        
                        <div class="room-form-row">
                            <select class="room-input" id="roomMode">
                                <option value="1v1">1v1 Battle</option>
                                <option value="4v4">4v4 Team Battle</option>
                                <option value="ffa">Free For All</option>
                                <option value="time-challenge">Time Challenge</option>
                            </select>
                            
                            <select class="room-input" id="roomDifficulty">
                                <option value="easy">Easy</option>
                                <option value="medium">Medium</option>
                                <option value="hard">Hard</option>
                                <option value="expert">Expert</option>
                            </select>
                        </div>
                        
                        <div class="room-form-row">
                            <input type="number" class="room-input" id="maxPlayers" min="2" max="8" value="4" placeholder="Max Players">
                            <input type="password" class="room-input" id="roomPassword" placeholder="Password (Optional)">
                        </div>
                        
                        <button type="submit" class="create-room-btn">
                            <i data-lucide="plus"></i>
                            Create Room
                        </button>
                    </form>
                </div>
            </div>

            <!-- Active Rooms -->
            <div style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); border-radius: 20px; padding: 30px;">
                <h3 style="margin-bottom: 20px; text-align: center; color: var(--primary);">🎯 Active Rooms</h3>
                <div id="activeRooms" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <!-- Rooms will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- Friends & Social Section -->
    <section style="padding: 60px 0; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">
            <div style="text-align: center; margin-bottom: 50px;">
                <h2 style="font-size: 2.5em; color: var(--text-primary); margin-bottom: 15px; font-weight: 800;">👥 Friends & Community</h2>
                <p style="color: var(--text-secondary); font-size: 1.2em;">Connect with other shortcut enthusiasts</p>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 40px;">
                <!-- Friend Requests -->
                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 20px; padding: 25px;">
                    <h3 style="margin-bottom: 20px; color: var(--primary);">📬 Friend Requests</h3>
                    <div id="friendRequests">
                        <!-- Friend requests will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Friends List -->
                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 20px; padding: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: var(--primary);">👫 Your Friends</h3>
                        <button id="findFriendsBtn" style="background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">
                            <i data-lucide="user-plus"></i>
                            Find Friends
                        </button>
                    </div>
                    <div class="friends-grid" id="friendsList">
                        <!-- Friends will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- User Profile Modal -->
    <div class="profile-modal" id="profileModal">
        <div class="profile-modal-content">
            <button class="profile-close" id="profileClose">&times;</button>
            
            <div class="profile-hero">
                <div class="profile-avatar-large" id="profileAvatar">MS</div>
                <div class="profile-username" id="profileUsername">Mark Smith</div>
                <div class="profile-title-large" id="profileTitle">Keyboard Shortcut Expert</div>
                <div class="profile-level" id="profileLevel">Level 25 Master</div>
            </div>

            <div class="social-actions" id="socialActions">
                <button class="social-btn" id="challengeBtn">
                    <i data-lucide="sword"></i>
                    Challenge
                </button>
                <button class="social-btn secondary" id="followBtn">
                    <i data-lucide="user-plus"></i>
                    Follow
                </button>
                <button class="social-btn secondary" id="messageBtn">
                    <i data-lucide="message-circle"></i>
                    Message
                </button>
            </div>

            <div class="profile-tabs">
                <button class="profile-tab active" data-tab="overview">Overview</button>
                <button class="profile-tab" data-tab="battles">Battle History</button>
                <button class="profile-tab" data-tab="achievements">Achievements</button>
                <button class="profile-tab" data-tab="stats">Statistics</button>
            </div>

            <div class="profile-content">
                <!-- Overview Tab -->
                <div class="profile-section active" id="overviewTab">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div style="text-align: center; padding: 20px; background: rgba(var(--primary-rgb), 0.1); border-radius: 16px;">
                            <div style="font-size: 2em; font-weight: 900; color: var(--primary);">156</div>
                            <div style="color: var(--text-secondary);">Total Battles</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: rgba(34, 197, 94, 0.1); border-radius: 16px;">
                            <div style="font-size: 2em; font-weight: 900; color: #22c55e;">89</div>
                            <div style="color: var(--text-secondary);">Wins</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: rgba(245, 158, 11, 0.1); border-radius: 16px;">
                            <div style="font-size: 2em; font-weight: 900; color: #f59e0b;">67%</div>
                            <div style="color: var(--text-secondary);">Win Rate</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: rgba(var(--accent), 0.1); border-radius: 16px;">
                            <div style="font-size: 2em; font-weight: 900; color: var(--accent);">1,892</div>
                            <div style="color: var(--text-secondary);">Total Score</div>
                        </div>
                    </div>

                    <div style="background: rgba(255, 255, 255, 0.8); border-radius: 16px; padding: 25px;">
                        <h4 style="margin-bottom: 15px; color: var(--primary);">🏆 Recent Achievements</h4>
                        <div style="display: grid; gap: 10px;">
                            <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: rgba(var(--primary-rgb), 0.05); border-radius: 12px;">
                                <span style="font-size: 2em;">🔥</span>
                                <div>
                                    <div style="font-weight: 700;">Hot Streak!</div>
                                    <div style="color: var(--text-secondary); font-size: 0.9em;">Won 5 battles in a row</div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: rgba(var(--primary-rgb), 0.05); border-radius: 12px;">
                                <span style="font-size: 2em;">⚡</span>
                                <div>
                                    <div style="font-weight: 700;">Speed Demon</div>
                                    <div style="color: var(--text-secondary); font-size: 0.9em;">Answered 20 questions in 60 seconds</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Battle History Tab -->
                <div class="profile-section" id="battlesTab">
                    <div class="battle-history" id="battleHistory">
                        <!-- Battle history will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Achievements Tab -->
                <div class="profile-section" id="achievementsTab">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <!-- Achievements will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Statistics Tab -->
                <div class="profile-section" id="statsTab">
                    <div style="display: grid; gap: 20px;">
                        <div style="background: rgba(255, 255, 255, 0.8); border-radius: 16px; padding: 25px;">
                            <h4 style="margin-bottom: 15px; color: var(--primary);">📊 Performance Analytics</h4>
                            <!-- Statistics charts would go here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Premium User Profiles Section -->
    <section class="user-profiles-section">
        <div class="profiles-background">
            <div class="floating-shapes"></div>
        </div>
        
        <div class="community-content">
            <div class="section-header">
                <h2>🌟 Featured Community Members</h2>
                <p>Meet our top contributors and shortcut experts who make our community amazing</p>
            </div>
            
            <div class="user-profiles-grid">
                <div class="user-profile-card">
                    <div class="profile-header">
                        <div class="user-avatar large expert">MS</div>
                        <div class="user-details">
                            <h3>Mark Smith</h3>
                            <p class="user-title">🚀 Keyboard Shortcut Expert</p>
                            <div class="user-badges">
                                <span class="badge moderator">🛡️ Moderator</span>
                                <span class="badge expert">⭐ Expert</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="profile-stats">
                        <div class="stat">
                            <span class="stat-number">156</span>
                            <span class="stat-label">Answers</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">892</span>
                            <span class="stat-label">Helpful Votes</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">45</span>
                            <span class="stat-label">Best Answers</span>
                        </div>
                    </div>
                    
                    <div class="profile-specialties">
                        <h4>🎯 Specialties:</h4>
                        <div class="specialty-tags">
                            <span class="tag">Windows</span>
                            <span class="tag">VS Code</span>
                            <span class="tag">Excel</span>
                        </div>
                    </div>
                </div>
                
                <div class="user-profile-card">
                    <div class="profile-header">
                        <div class="user-avatar large designer">LG</div>
                        <div class="user-details">
                            <h3>Lisa Garcia</h3>
                            <p class="user-title">🎨 Design Tools Specialist</p>
                            <div class="user-badges">
                                <span class="badge expert">⭐ Expert</span>
                                <span class="badge contributor">🏆 Top Contributor</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="profile-stats">
                        <div class="stat">
                            <span class="stat-number">98</span>
                            <span class="stat-label">Answers</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">654</span>
                            <span class="stat-label">Helpful Votes</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">32</span>
                            <span class="stat-label">Best Answers</span>
                        </div>
                    </div>
                    
                    <div class="profile-specialties">
                        <h4>🎯 Specialties:</h4>
                        <div class="specialty-tags">
                            <span class="tag">Photoshop</span>
                            <span class="tag">Figma</span>
                            <span class="tag">Illustrator</span>
                        </div>
                    </div>
                </div>
                
                <div class="user-profile-card">
                    <div class="profile-header">
                        <div class="user-avatar large office">DR</div>
                        <div class="user-details">
                            <h3>David Rodriguez</h3>
                            <p class="user-title">📊 Office Suite Master</p>
                            <div class="user-badges">
                                <span class="badge expert">⭐ Expert</span>
                                <span class="badge helper">💝 Helper</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="profile-stats">
                        <div class="stat">
                            <span class="stat-number">203</span>
                            <span class="stat-label">Answers</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">1247</span>
                            <span class="stat-label">Helpful Votes</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">67</span>
                            <span class="stat-label">Best Answers</span>
                        </div>
                    </div>
                    
                    <div class="profile-specialties">
                        <h4>🎯 Specialties:</h4>
                        <div class="specialty-tags">
                            <span class="tag">Excel</span>
                            <span class="tag">PowerPoint</span>
                            <span class="tag">Word</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Premium Footer -->
    <footer class="footer-modern">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Shortcut Sensei</h3>
                    <p>Master keyboard shortcuts and boost your productivity with our comprehensive learning platform.</p>
                    <div class="footer-social">
                        <a href="#" class="social-link"><i data-lucide="twitter"></i></a>
                        <a href="#" class="social-link"><i data-lucide="github"></i></a>
                        <a href="#" class="social-link"><i data-lucide="linkedin"></i></a>
                        <a href="#" class="social-link"><i data-lucide="youtube"></i></a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4>Learning</h4>
                    <ul>
                        <li><a href="all-applications-enhanced.html">Applications</a></li>
                        <li><a href="quiz-enhanced.html">Interactive Quiz</a></li>
                        <li><a href="#tutorials">Video Tutorials</a></li>
                        <li><a href="#practice">Practice Mode</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Community</h4>
                    <ul>
                        <li><a href="community-enhanced.html">Q&A Forum</a></li>
                        <li><a href="#quiz">Community Quiz</a></li>
                        <li><a href="#profiles">Member Profiles</a></li>
                        <li><a href="#help">Help & Support</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="About-enhanced.html">About Us</a></li>
                        <li><a href="#help">Help Center</a></li>
                        <li><a href="#contact">Contact</a></li>
                        <li><a href="#feedback">Feedback</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 Shortcut Sensei. All rights reserved.</p>
                <div class="footer-links">
                    <a href="#privacy">Privacy Policy</a>
                    <a href="#terms">Terms of Service</a>
                    <a href="#cookies">Cookie Policy</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Premium JavaScript -->
    <script>
        // Premium Community Quiz with Cool Animations
        class PremiumCommunityQuiz {
            constructor() {
                this.currentMode = 'solo';
                this.currentQuestion = 0;
                this.score = 0;
                this.streak = 0;
                this.timer = null;
                this.timePerQuestion = 30;
                this.totalQuestions = 10;
                this.questions = [
                    {
                        question: "Which shortcut opens the Task Manager in Windows?",
                        options: ["Ctrl + Alt + Del", "Ctrl + Shift + Esc", "Alt + F4", "Windows + R"],
                        correct: 1
                    },
                    {
                        question: "What is the shortcut to copy text?",
                        options: ["Ctrl + C", "Ctrl + V", "Ctrl + X", "Ctrl + Z"],
                        correct: 0
                    },
                    {
                        question: "Which shortcut is used to undo an action?",
                        options: ["Ctrl + Y", "Ctrl + Z", "Ctrl + A", "Ctrl + S"],
                        correct: 1
                    },
                    {
                        question: "What shortcut opens a new browser tab?",
                        options: ["Ctrl + N", "Ctrl + T", "Ctrl + W", "Ctrl + R"],
                        correct: 1
                    },
                    {
                        question: "Which shortcut selects all text?",
                        options: ["Ctrl + A", "Ctrl + S", "Ctrl + D", "Ctrl + F"],
                        correct: 0
                    },
                    {
                        question: "What is the shortcut to save a file?",
                        options: ["Ctrl + O", "Ctrl + S", "Ctrl + N", "Ctrl + P"],
                        correct: 1
                    },
                    {
                        question: "Which shortcut refreshes the browser?",
                        options: ["F4", "F5", "F6", "F7"],
                        correct: 1
                    },
                    {
                        question: "What shortcut opens the find dialog?",
                        options: ["Ctrl + F", "Ctrl + H", "Ctrl + G", "Ctrl + L"],
                        correct: 0
                    },
                    {
                        question: "Which shortcut minimizes all windows?",
                        options: ["Windows + M", "Windows + D", "Alt + Tab", "Ctrl + Alt + M"],
                        correct: 1
                    },
                    {
                        question: "What is the shortcut to switch between applications?",
                        options: ["Alt + Tab", "Ctrl + Tab", "Windows + Tab", "Shift + Tab"],
                        correct: 0
                    }
                ];
                
                // User data and battle history
                this.currentUser = {
                    id: 'user1',
                    username: 'ShortcutMaster',
                    level: 25,
                    totalBattles: 156,
                    wins: 89,
                    losses: 67,
                    winRate: 57.1,
                    totalScore: 1892,
                    friends: [],
                    battleHistory: []
                };

                this.friends = [
                    { id: 'f1', username: 'KeyboardNinja', status: 'online', level: 22 },
                    { id: 'f2', username: 'SpeedTyper', status: 'in-battle', level: 18 },
                    { id: 'f3', username: 'ShortcutSage', status: 'offline', level: 30 }
                ];

                this.friendRequests = [
                    { id: 'r1', username: 'NewPlayer123', level: 5, message: 'Hey! Let\'s be friends!' },
                    { id: 'r2', username: 'ProGamer', level: 15, message: 'Great battles yesterday!' }
                ];

                this.activeRooms = [
                    { id: 'room1', name: 'Quick Battle Arena', mode: '1v1', players: 2, maxPlayers: 2, difficulty: 'medium', hasPassword: false },
                    { id: 'room2', name: 'Team Championship', mode: '4v4', players: 6, maxPlayers: 8, difficulty: 'hard', hasPassword: true },
                    { id: 'room3', name: 'Beginner\'s Lounge', mode: 'ffa', players: 3, maxPlayers: 4, difficulty: 'easy', hasPassword: false }
                ];

                this.battleHistory = [
                    {
                        id: 'b1',
                        date: '2024-12-18',
                        mode: '1v1',
                        result: 'win',
                        score: 95,
                        opponentScore: 70,
                        opponent: 'KeyboardNinja',
                        duration: '3:45',
                        accuracy: 85
                    },
                    {
                        id: 'b2',
                        date: '2024-12-17',
                        mode: 'time-challenge',
                        result: 'win',
                        score: 120,
                        correctAnswers: 18,
                        totalAttempts: 22,
                        duration: '1:00',
                        accuracy: 82
                    },
                    {
                        id: 'b3',
                        date: '2024-12-16',
                        mode: '4v4',
                        result: 'loss',
                        score: 65,
                        teamScore: 280,
                        opponentTeamScore: 310,
                        duration: '5:20',
                        accuracy: 75
                    }
                ];

                this.isInQueue = false;
                this.queueTimer = 0;
                this.queueInterval = null;
                
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.setupSettings();
                this.showModeSelection();
                this.populateActiveRooms();
                this.populateFriendsList();
                this.populateFriendRequests();
                this.setupProfileModal();
            }

            setupEventListeners() {
                // Quiz mode selection
                document.querySelectorAll('.mode-card').forEach(card => {
                    card.addEventListener('click', () => this.selectMode(card.dataset.mode));
                });

                // Settings
                const questionCount = document.getElementById('questionCount');
                const timePerQuestion = document.getElementById('timePerQuestion');
                
                if (questionCount) questionCount.addEventListener('input', this.updateQuestionCount.bind(this));
                if (timePerQuestion) timePerQuestion.addEventListener('input', this.updateTimeSettings.bind(this));

                // Quiz controls
                const startBtn = document.getElementById('startQuiz');
                if (startBtn) startBtn.addEventListener('click', this.startQuiz.bind(this));

                const nextBtn = document.getElementById('nextQuestion');
                if (nextBtn) nextBtn.addEventListener('click', this.nextQuestion.bind(this));

                const cancelBtn = document.getElementById('cancelBattle');
                if (cancelBtn) cancelBtn.addEventListener('click', this.cancelBattle.bind(this));

                // Quiz options
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('quiz-option')) {
                        this.selectAnswer(e.target);
                    }
                });

                // Random battle queue
                const joinQueueBtn = document.getElementById('joinQueueBtn');
                const cancelQueueBtn = document.getElementById('cancelQueueBtn');
                
                if (joinQueueBtn) joinQueueBtn.addEventListener('click', this.joinRandomQueue.bind(this));
                if (cancelQueueBtn) cancelQueueBtn.addEventListener('click', this.cancelRandomQueue.bind(this));

                // Room creation
                const roomForm = document.getElementById('roomForm');
                if (roomForm) roomForm.addEventListener('submit', this.createRoom.bind(this));

                // Profile modal
                const profileClose = document.getElementById('profileClose');
                if (profileClose) profileClose.addEventListener('click', this.closeProfileModal.bind(this));

                // Profile tabs
                document.querySelectorAll('.profile-tab').forEach(tab => {
                    tab.addEventListener('click', () => this.switchProfileTab(tab.dataset.tab));
                });

                // Social actions
                const challengeBtn = document.getElementById('challengeBtn');
                const followBtn = document.getElementById('followBtn');
                const messageBtn = document.getElementById('messageBtn');
                
                if (challengeBtn) challengeBtn.addEventListener('click', this.challengeUser.bind(this));
                if (followBtn) followBtn.addEventListener('click', this.followUser.bind(this));
                if (messageBtn) messageBtn.addEventListener('click', this.messageUser.bind(this));

                // Find friends
                const findFriendsBtn = document.getElementById('findFriendsBtn');
                if (findFriendsBtn) findFriendsBtn.addEventListener('click', this.findFriends.bind(this));
            }

            // Random Battle Queue Functions
            joinRandomQueue() {
                this.isInQueue = true;
                this.queueTimer = 0;
                
                const queueStatus = document.getElementById('queueStatus');
                const queueTimerEl = document.getElementById('queueTimer');
                const joinQueueBtn = document.getElementById('joinQueueBtn');
                const cancelQueueBtn = document.getElementById('cancelQueueBtn');
                
                if (queueStatus) queueStatus.textContent = 'Searching for opponent...';
                if (queueTimerEl) queueTimerEl.style.display = 'block';
                if (joinQueueBtn) joinQueueBtn.style.display = 'none';
                if (cancelQueueBtn) cancelQueueBtn.style.display = 'block';

                this.queueInterval = setInterval(() => {
                    this.queueTimer++;
                    const minutes = Math.floor(this.queueTimer / 60);
                    const seconds = this.queueTimer % 60;
                    if (queueTimerEl) queueTimerEl.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                    // Simulate finding opponent after 3-8 seconds
                    if (this.queueTimer >= 3 && Math.random() > 0.7) {
                        this.foundOpponent();
                    }
                }, 1000);
            }

            cancelRandomQueue() {
                this.isInQueue = false;
                clearInterval(this.queueInterval);
                
                const queueStatus = document.getElementById('queueStatus');
                const queueTimerEl = document.getElementById('queueTimer');
                const joinQueueBtn = document.getElementById('joinQueueBtn');
                const cancelQueueBtn = document.getElementById('cancelQueueBtn');
                
                if (queueStatus) queueStatus.textContent = 'Ready to Battle!';
                if (queueTimerEl) queueTimerEl.style.display = 'none';
                if (joinQueueBtn) joinQueueBtn.style.display = 'block';
                if (cancelQueueBtn) cancelQueueBtn.style.display = 'none';
            }

            foundOpponent() {
                this.cancelRandomQueue();
                
                const queueStatus = document.getElementById('queueStatus');
                if (queueStatus) queueStatus.textContent = 'Opponent Found! Starting Battle...';
                
                setTimeout(() => {
                    this.currentMode = '1v1';
                    this.startBattle();
                }, 2000);
            }

            // Room Management
            createRoom(e) {
                e.preventDefault();
                
                const roomName = document.getElementById('roomName').value;
                const roomMode = document.getElementById('roomMode').value;
                const roomDifficulty = document.getElementById('roomDifficulty').value;
                const maxPlayers = document.getElementById('maxPlayers').value;
                const roomPassword = document.getElementById('roomPassword').value;

                const newRoom = {
                    id: 'room' + Date.now(),
                    name: roomName,
                    mode: roomMode,
                    difficulty: roomDifficulty,
                    players: 1,
                    maxPlayers: parseInt(maxPlayers),
                    hasPassword: roomPassword.length > 0,
                    owner: this.currentUser.username
                };

                this.activeRooms.push(newRoom);
                this.populateActiveRooms();
                
                // Reset form
                document.getElementById('roomForm').reset();
                
                alert(`Room "${roomName}" created successfully!`);
            }

            populateActiveRooms() {
                const activeRoomsEl = document.getElementById('activeRooms');
                if (!activeRoomsEl) return;

                activeRoomsEl.innerHTML = this.activeRooms.map(room => `
                    <div style="background: rgba(255, 255, 255, 0.9); border-radius: 16px; padding: 20px; border-left: 4px solid var(--primary);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="color: var(--primary); margin: 0;">${room.name}</h4>
                            <span style="background: var(--primary); color: white; padding: 4px 8px; border-radius: 8px; font-size: 0.8em;">${room.mode}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <span style="color: var(--text-secondary);">Players: ${room.players}/${room.maxPlayers}</span>
                            <span style="color: var(--text-secondary);">Difficulty: ${room.difficulty}</span>
                            ${room.hasPassword ? '<i data-lucide="lock" style="color: var(--accent);"></i>' : ''}
                        </div>
                        <button onclick="communityQuiz.joinRoom('${room.id}')" style="width: 100%; background: linear-gradient(135deg, var(--primary), var(--accent)); color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Join Room
                        </button>
                    </div>
                `).join('');

                // Re-initialize Lucide icons
                if (window.lucide) {
                    lucide.createIcons();
                }
            }

            joinRoom(roomId) {
                const room = this.activeRooms.find(r => r.id === roomId);
                if (room) {
                    if (room.hasPassword) {
                        const password = prompt('Enter room password:');
                        if (!password) return;
                    }
                    
                    alert(`Joining room: ${room.name}`);
                    // Here you would implement actual room joining logic
                }
            }

            // Friends Management
            populateFriendsList() {
                const friendsListEl = document.getElementById('friendsList');
                if (!friendsListEl) return;

                friendsListEl.innerHTML = this.friends.map(friend => `
                    <div class="friend-card">
                        <div class="friend-avatar">${friend.username.slice(0, 2).toUpperCase()}</div>
                        <div class="friend-name">${friend.username}</div>
                        <div class="friend-status">Level ${friend.level} • ${friend.status}</div>
                        <div class="friend-actions">
                            <button class="friend-btn primary" onclick="communityQuiz.challengeFriend('${friend.id}')">Challenge</button>
                            <button class="friend-btn" onclick="communityQuiz.openProfile('${friend.id}')">Profile</button>
                        </div>
                    </div>
                `).join('');
            }

            populateFriendRequests() {
                const friendRequestsEl = document.getElementById('friendRequests');
                if (!friendRequestsEl) return;

                if (this.friendRequests.length === 0) {
                    friendRequestsEl.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No pending requests</p>';
                    return;
                }

                friendRequestsEl.innerHTML = this.friendRequests.map(request => `
                    <div style="background: rgba(255, 255, 255, 0.8); border-radius: 12px; padding: 15px; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <strong>${request.username}</strong>
                            <span style="color: var(--text-secondary); font-size: 0.9em;">Level ${request.level}</span>
                        </div>
                        <p style="margin-bottom: 10px; font-size: 0.9em; color: var(--text-secondary);">${request.message}</p>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="communityQuiz.acceptFriendRequest('${request.id}')" style="flex: 1; background: #22c55e; color: white; border: none; padding: 8px; border-radius: 8px; cursor: pointer;">Accept</button>
                            <button onclick="communityQuiz.rejectFriendRequest('${request.id}')" style="flex: 1; background: #ef4444; color: white; border: none; padding: 8px; border-radius: 8px; cursor: pointer;">Decline</button>
                        </div>
                    </div>
                `).join('');
            }

            challengeFriend(friendId) {
                const friend = this.friends.find(f => f.id === friendId);
                if (friend) {
                    if (friend.status === 'offline') {
                        alert(`${friend.username} is currently offline.`);
                        return;
                    }
                    if (friend.status === 'in-battle') {
                        alert(`${friend.username} is currently in a battle.`);
                        return;
                    }
                    
                    alert(`Challenge sent to ${friend.username}!`);
                    // Here you would implement actual challenge logic
                }
            }

            acceptFriendRequest(requestId) {
                const request = this.friendRequests.find(r => r.id === requestId);
                if (request) {
                    this.friends.push({
                        id: request.id,
                        username: request.username,
                        level: request.level,
                        status: 'online'
                    });
                    
                    this.friendRequests = this.friendRequests.filter(r => r.id !== requestId);
                    this.populateFriendsList();
                    this.populateFriendRequests();
                    
                    alert(`${request.username} is now your friend!`);
                }
            }

            rejectFriendRequest(requestId) {
                this.friendRequests = this.friendRequests.filter(r => r.id !== requestId);
                this.populateFriendRequests();
            }

            findFriends() {
                alert('Opening friend finder... (Feature would show suggested friends based on skill level and activity)');
            }

            // Profile Modal Functions
            setupProfileModal() {
                this.populateBattleHistory();
            }

            openProfile(userId) {
                const profileModal = document.getElementById('profileModal');
                if (profileModal) {
                    profileModal.classList.add('active');
                    this.loadUserProfile(userId);
                }
            }

            closeProfileModal() {
                const profileModal = document.getElementById('profileModal');
                if (profileModal) {
                    profileModal.classList.remove('active');
                }
            }

            loadUserProfile(userId) {
                // Simulate loading user data
                const userData = {
                    username: 'KeyboardNinja',
                    title: 'Speed Typing Champion',
                    level: 22,
                    avatar: 'KN'
                };

                const profileAvatar = document.getElementById('profileAvatar');
                const profileUsername = document.getElementById('profileUsername');
                const profileTitle = document.getElementById('profileTitle');
                const profileLevel = document.getElementById('profileLevel');

                if (profileAvatar) profileAvatar.textContent = userData.avatar;
                if (profileUsername) profileUsername.textContent = userData.username;
                if (profileTitle) profileTitle.textContent = userData.title;
                if (profileLevel) profileLevel.textContent = `Level ${userData.level} Expert`;
            }

            switchProfileTab(tabName) {
                // Hide all sections
                document.querySelectorAll('.profile-section').forEach(section => {
                    section.classList.remove('active');
                });

                // Remove active class from all tabs
                document.querySelectorAll('.profile-tab').forEach(tab => {
                    tab.classList.remove('active');
                });

                // Show selected section and activate tab
                const selectedSection = document.getElementById(tabName + 'Tab');
                const selectedTab = document.querySelector(`[data-tab="${tabName}"]`);

                if (selectedSection) selectedSection.classList.add('active');
                if (selectedTab) selectedTab.classList.add('active');
            }

            populateBattleHistory() {
                const battleHistoryEl = document.getElementById('battleHistory');
                if (!battleHistoryEl) return;

                battleHistoryEl.innerHTML = this.battleHistory.map(battle => `
                    <div class="battle-record ${battle.result}">
                        <div class="battle-header">
                            <div class="battle-result ${battle.result}">${battle.result.toUpperCase()}</div>
                            <div class="battle-mode">${battle.mode}</div>
                        </div>
                        <div class="battle-details">
                            <div class="battle-stat">
                                <div class="battle-stat-value">${battle.score}</div>
                                <div class="battle-stat-label">Your Score</div>
                            </div>
                            <div class="battle-stat">
                                <div class="battle-stat-value">${battle.accuracy}%</div>
                                <div class="battle-stat-label">Accuracy</div>
                            </div>
                            <div class="battle-stat">
                                <div class="battle-stat-value">${battle.duration}</div>
                                <div class="battle-stat-label">Duration</div>
                            </div>
                            <div class="battle-stat">
                                <div class="battle-stat-value">${battle.date}</div>
                                <div class="battle-stat-label">Date</div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            challengeUser() {
                alert('Challenge sent! Waiting for opponent to accept...');
            }

            followUser() {
                const followBtn = document.getElementById('followBtn');
                if (followBtn) {
                    if (followBtn.textContent.includes('Follow')) {
                        followBtn.innerHTML = '<i data-lucide="user-check"></i> Following';
                        followBtn.classList.add('primary');
                    } else {
                        followBtn.innerHTML = '<i data-lucide="user-plus"></i> Follow';
                        followBtn.classList.remove('primary');
                    }
                }
                if (window.lucide) lucide.createIcons();
            }

            messageUser() {
                alert('Opening message composer... (Feature would open a private messaging interface)');
            }

            // Existing quiz methods with battle history tracking
            endQuiz() {
                clearInterval(this.timer);
                
                // Add battle to history
                const battleResult = {
                    id: 'b' + Date.now(),
                    date: new Date().toISOString().split('T')[0],
                    mode: this.currentMode,
                    result: this.score >= (this.totalQuestions * 7) ? 'win' : 'loss', // 70% threshold
                    score: this.score,
                    correctAnswers: Math.floor(this.score / 10),
                    totalQuestions: this.totalQuestions,
                    duration: this.getCurrentDuration(),
                    accuracy: Math.round((this.score / (this.totalQuestions * 10)) * 100)
                };

                this.battleHistory.unshift(battleResult);
                this.currentUser.totalBattles++;
                if (battleResult.result === 'win') {
                    this.currentUser.wins++;
                } else {
                    this.currentUser.losses++;
                }
                this.currentUser.winRate = Math.round((this.currentUser.wins / this.currentUser.totalBattles) * 100);

                alert(`Quiz Complete! Final Score: ${this.score} points`);
                this.showModeSelection();
            }

            getCurrentDuration() {
                // Simple duration calculation - in real app, track start time
                return Math.floor(Math.random() * 300) + 60 + 's'; // Random duration for demo
            }

            // ... (rest of the existing quiz methods remain the same)
            setupSettings() {
                this.updateQuestionCount();
                this.updateTimeSettings();
            }

            updateQuestionCount() {
                const count = document.getElementById('questionCount')?.value || 10;
                const display = document.getElementById('questionCountDisplay');
                if (display) display.textContent = count;
                this.totalQuestions = parseInt(count);
            }

            updateTimeSettings() {
                const time = document.getElementById('timePerQuestion')?.value || 30;
                const display = document.getElementById('timeDisplay');
                if (display) display.textContent = time + 's';
                this.timePerQuestion = parseInt(time);
            }

            selectMode(mode) {
                this.currentMode = mode;
                
                // Update UI
                document.querySelectorAll('.mode-card').forEach(card => {
                    card.classList.remove('active');
                });
                const selectedCard = document.querySelector(`[data-mode="${mode}"]`);
                if (selectedCard) selectedCard.classList.add('active');

                // Show settings for solo/time modes
                const settingsEl = document.getElementById('quizSettings');
                if (settingsEl) {
                    if (mode === 'solo' || mode === 'time-challenge') {
                        settingsEl.style.display = 'block';
                    } else {
                        settingsEl.style.display = 'none';
                    }
                }
            }

            showModeSelection() {
                const elements = {
                    quizModes: document.getElementById('quizModes'),
                    quizSettings: document.getElementById('quizSettings'),
                    startContainer: document.getElementById('startContainer'),
                    soloQuiz: document.getElementById('soloQuiz'),
                    timeChallenge: document.getElementById('timeChallenge'),
                    battleArena: document.getElementById('battleArena')
                };

                if (elements.quizModes) elements.quizModes.style.display = 'grid';
                if (elements.quizSettings) elements.quizSettings.style.display = 'block';
                if (elements.startContainer) elements.startContainer.style.display = 'block';
                if (elements.soloQuiz) elements.soloQuiz.style.display = 'none';
                if (elements.timeChallenge) elements.timeChallenge.style.display = 'none';
                if (elements.battleArena) elements.battleArena.style.display = 'none';
            }

            startQuiz() {
                this.currentQuestion = 0;
                this.score = 0;
                this.streak = 0;

                // Hide mode selection
                const elements = {
                    quizModes: document.getElementById('quizModes'),
                    quizSettings: document.getElementById('quizSettings'),
                    startContainer: document.getElementById('startContainer')
                };

                if (elements.quizModes) elements.quizModes.style.display = 'none';
                if (elements.quizSettings) elements.quizSettings.style.display = 'none';
                if (elements.startContainer) elements.startContainer.style.display = 'none';

                switch (this.currentMode) {
                    case 'solo':
                        this.startSoloQuiz();
                        break;
                    case 'time-challenge':
                        this.startTimeChallenge();
                        break;
                    case '1v1':
                    case '4v4':
                    case 'ffa':
                        this.startBattle();
                        break;
                }
            }

            startSoloQuiz() {
                const soloQuiz = document.getElementById('soloQuiz');
                if (soloQuiz) soloQuiz.style.display = 'block';
                this.loadQuestion();
                this.startTimer();
            }

            startTimeChallenge() {
                const timeChallenge = document.getElementById('timeChallenge');
                if (timeChallenge) timeChallenge.style.display = 'block';
                
                this.challengeTimer = 60; // 60 second challenge
                this.correctAnswers = 0;
                this.totalAttempts = 0;
                
                this.updateChallengeStats();
                this.loadChallengeQuestion();
                this.startChallengeTimer();
            }

            startBattle() {
                const battleArena = document.getElementById('battleArena');
                const waitingRoom = document.getElementById('waitingRoom');
                
                if (battleArena) battleArena.style.display = 'block';
                if (waitingRoom) waitingRoom.style.display = 'block';
                
                // Simulate finding opponents
                setTimeout(() => {
                    if (waitingRoom) waitingRoom.style.display = 'none';
                    this.loadBattleQuestion();
                    this.startBattleTimer();
                }, 2000);
            }

            loadQuestion() {
                const question = this.questions[this.currentQuestion];
                const questionEl = document.getElementById('currentQuestion');
                if (questionEl) questionEl.textContent = question.question;
                
                const optionsEl = document.getElementById('quizAnswers');
                if (optionsEl) {
                    optionsEl.innerHTML = '';
                    
                    question.options.forEach((option, index) => {
                        const btn = document.createElement('button');
                        btn.className = 'quiz-option';
                        btn.textContent = option;
                        btn.dataset.answer = index;
                        optionsEl.appendChild(btn);
                    });
                }

                // Update progress
                const progressEl = document.getElementById('questionProgress');
                if (progressEl) progressEl.textContent = `Question ${this.currentQuestion + 1} of ${this.totalQuestions}`;
                
                const progressFill = document.getElementById('progressFill');
                if (progressFill) progressFill.style.width = `${((this.currentQuestion + 1) / this.totalQuestions) * 100}%`;
                
                // Update score display
                const scoreEl = document.getElementById('currentScore');
                if (scoreEl) scoreEl.textContent = this.score;
                
                const streakEl = document.getElementById('streakDisplay');
                if (streakEl) streakEl.textContent = `🔥 ${this.streak} Streak`;
            }

            loadChallengeQuestion() {
                const randomIndex = Math.floor(Math.random() * this.questions.length);
                const question = this.questions[randomIndex];
                
                const questionEl = document.getElementById('challengeQuestionText');
                if (questionEl) questionEl.textContent = question.question;
                
                const optionsEl = document.getElementById('challengeAnswers');
                if (optionsEl) {
                    optionsEl.innerHTML = '';
                    
                    question.options.forEach((option, index) => {
                        const btn = document.createElement('button');
                        btn.className = 'quiz-option';
                        btn.textContent = option;
                        btn.dataset.answer = index;
                        btn.dataset.correct = question.correct;
                        optionsEl.appendChild(btn);
                    });
                }
            }

            loadBattleQuestion() {
                const randomIndex = Math.floor(Math.random() * this.questions.length);
                const question = this.questions[randomIndex];
                
                const questionEl = document.getElementById('battleQuestionText');
                if (questionEl) questionEl.textContent = question.question;
                
                const optionsEl = document.getElementById('battleAnswers');
                if (optionsEl) {
                    optionsEl.innerHTML = '';
                    
                    question.options.forEach((option, index) => {
                        const btn = document.createElement('button');
                        btn.className = 'quiz-option';
                        btn.textContent = option;
                        btn.dataset.answer = index;
                        btn.dataset.correct = question.correct;
                        optionsEl.appendChild(btn);
                    });
                }
            }

            selectAnswer(button) {
                if (button.classList.contains('selected')) return;

                const isCorrect = parseInt(button.dataset.answer) === this.questions[this.currentQuestion]?.correct ||
                                parseInt(button.dataset.answer) === parseInt(button.dataset.correct);

                // Clear previous selections
                button.parentElement.querySelectorAll('.quiz-option').forEach(btn => {
                    btn.classList.remove('selected', 'correct', 'incorrect');
                });

                // Mark selection
                button.classList.add('selected');
                
                if (isCorrect) {
                    button.classList.add('correct');
                    this.score += 10;
                    this.streak++;
                    
                    // Bonus for streak
                    if (this.streak >= 3) {
                        this.score += this.streak;
                    }
                } else {
                    button.classList.add('incorrect');
                    this.streak = 0;
                    
                    // Show correct answer
                    const correctBtn = button.parentElement.querySelector(`[data-answer="${this.questions[this.currentQuestion]?.correct || button.dataset.correct}"]`);
                    if (correctBtn) correctBtn.classList.add('correct');
                }

                // Handle different modes
                if (this.currentMode === 'time-challenge') {
                    this.totalAttempts++;
                    if (isCorrect) this.correctAnswers++;
                    this.updateChallengeStats();
                    
                    setTimeout(() => {
                        this.loadChallengeQuestion();
                    }, 1000);
                } else if (this.currentMode.includes('v')) {
                    // Battle mode
                    if (isCorrect) {
                        const yourScore = document.getElementById('yourScore');
                        if (yourScore) yourScore.textContent = parseInt(yourScore.textContent) + 1;
                    }
                    
                    // Simulate opponent answer
                    setTimeout(() => {
                        if (Math.random() > 0.3) { // 70% chance opponent gets it right
                            const opponentScore = document.getElementById('opponentScore');
                            if (opponentScore) opponentScore.textContent = parseInt(opponentScore.textContent) + 1;
                        }
                        this.loadBattleQuestion();
                    }, 1500);
                } else {
                    // Solo mode
                    setTimeout(() => {
                        const nextBtn = document.getElementById('nextQuestion');
                        if (nextBtn) nextBtn.style.display = 'block';
                    }, 1000);
                }
            }

            nextQuestion() {
                this.currentQuestion++;
                
                if (this.currentQuestion >= this.totalQuestions) {
                    this.endQuiz();
                } else {
                    this.loadQuestion();
                    this.startTimer();
                    const nextBtn = document.getElementById('nextQuestion');
                    if (nextBtn) nextBtn.style.display = 'none';
                }
            }

            startTimer() {
                clearInterval(this.timer);
                let timeLeft = this.timePerQuestion;
                const timerEl = document.getElementById('quizTimer');
                if (timerEl) timerEl.textContent = timeLeft;
                
                this.timer = setInterval(() => {
                    timeLeft--;
                    if (timerEl) timerEl.textContent = timeLeft;
                    
                    if (timeLeft <= 0) {
                        clearInterval(this.timer);
                        this.autoNextQuestion();
                    }
                }, 1000);
            }

            startChallengeTimer() {
                const timerEl = document.getElementById('challengeTimer');
                
                this.challengeInterval = setInterval(() => {
                    this.challengeTimer--;
                    if (timerEl) timerEl.textContent = this.challengeTimer;
                    
                    if (this.challengeTimer <= 0) {
                        clearInterval(this.challengeInterval);
                        this.endTimeChallenge();
                    }
                }, 1000);
            }

            startBattleTimer() {
                const timerEl = document.getElementById('battleTimer');
                let timeLeft = 30;
                
                this.battleInterval = setInterval(() => {
                    timeLeft--;
                    if (timerEl) timerEl.textContent = timeLeft;
                    
                    if (timeLeft <= 0) {
                        clearInterval(this.battleInterval);
                        this.endBattle();
                    }
                }, 1000);
            }

            updateChallengeStats() {
                const correctEl = document.getElementById('correctAnswers');
                const totalEl = document.getElementById('totalAttempts');
                const accuracyEl = document.getElementById('accuracy');
                
                if (correctEl) correctEl.textContent = this.correctAnswers;
                if (totalEl) totalEl.textContent = this.totalAttempts;
                
                const accuracy = this.totalAttempts > 0 ? Math.round((this.correctAnswers / this.totalAttempts) * 100) : 0;
                if (accuracyEl) accuracyEl.textContent = accuracy + '%';
            }

            autoNextQuestion() {
                this.streak = 0;
                this.nextQuestion();
            }

            endTimeChallenge() {
                clearInterval(this.challengeInterval);
                alert(`Time Challenge Complete! You got ${this.correctAnswers} correct out of ${this.totalAttempts} attempts!`);
                this.showModeSelection();
            }

            endBattle() {
                clearInterval(this.battleInterval);
                const yourScore = parseInt(document.getElementById('yourScore')?.textContent || '0');
                const opponentScore = parseInt(document.getElementById('opponentScore')?.textContent || '0');
                
                if (yourScore > opponentScore) {
                    alert(`You Won! ${yourScore} - ${opponentScore}`);
                } else if (opponentScore > yourScore) {
                    alert(`You Lost! ${yourScore} - ${opponentScore}`);
                } else {
                    alert(`It's a Tie! ${yourScore} - ${opponentScore}`);
                }
                
                this.showModeSelection();
                
                // Reset scores
                const yourScoreEl = document.getElementById('yourScore');
                const opponentScoreEl = document.getElementById('opponentScore');
                if (yourScoreEl) yourScoreEl.textContent = '0';
                if (opponentScoreEl) opponentScoreEl.textContent = '0';
            }

            cancelBattle() {
                clearInterval(this.battleInterval);
                this.showModeSelection();
            }
        }

        // Initialize the community quiz system
        let communityQuiz;
        document.addEventListener('DOMContentLoaded', () => {
            communityQuiz = new PremiumCommunityQuiz();
            
            // Initialize Lucide icons
            if (window.lucide) {
                lucide.createIcons();
            }
        });

        // Premium Stats Animation
        function animateStats() {
            const statNumbers = document.querySelectorAll('.stat-number');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const target = parseInt(entry.target.textContent.replace(/,/g, ''));
                        animateNumber(entry.target, 0, target, 2000);
                    }
                });
            });

            statNumbers.forEach(stat => observer.observe(stat));
        }

        function animateNumber(element, start, end, duration) {
            const startTime = performance.now();
            
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                const current = Math.floor(start + (end - start) * easeOutQuart(progress));
                element.textContent = current.toLocaleString();
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            requestAnimationFrame(update);
        }

        function easeOutQuart(t) {
            return 1 - Math.pow(1 - t, 4);
        }

        // Form Enhancement
        function enhanceForm() {
            const form = document.getElementById('questionForm');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const submitBtn = this.querySelector('.form-submit');
                    const originalText = submitBtn.innerHTML;
                    
                    submitBtn.innerHTML = '<i data-lucide="loader-2" style="animation: spin 1s linear infinite;"></i> Posting...';
                    submitBtn.disabled = true;
                    
                    setTimeout(() => {
                        submitBtn.innerHTML = '<i data-lucide="check"></i> Posted Successfully!';
                        submitBtn.style.background = '#22c55e';
                        
                        setTimeout(() => {
                            form.reset();
                            submitBtn.innerHTML = originalText;
                            submitBtn.style.background = '';
                            submitBtn.disabled = false;
                        }, 2000);
                    }, 1500);
                });
            }
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Lucide icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
            
            // Initialize premium quiz
            new PremiumCommunityQuiz();
            
            // Initialize stats animation
            animateStats();
            
            // Enhance form
            enhanceForm();
            
            // Add scroll animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.animation = 'fadeInUp 0.8s ease-out';
                    }
                });
            });

            document.querySelectorAll('.user-profile-card, .quiz-card, .quiz-leaderboard').forEach(el => {
                observer.observe(el);
            });
        });
    </script>
</body>
</html>
